var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,c){a.raw=c;return a};$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};
$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,d){a!=Array.prototype&&a!=Object.prototype&&(a[c]=d.value)};
$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,a];for(var c=0;c<a.length;++c){var d=a[c];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,c){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:c})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(d){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(d||"")+"_"+c++,d)}var c=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var d=0,b={next:function(){if(d<a.length){var g=d++;return{value:c(g,a[g]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};
$jscomp.polyfill=function(a,c,d,b){if(c){d=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var g=a[b];g in d||(d[g]={});d=d[g]}a=a[a.length-1];b=d[a];c=c(b);c!=b&&null!=c&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.polyfill("Object.is",function(a){return a?a:function(a,d){return a===d?0!==a||1/a===1/d:a!==a&&d!==d}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,d){var b=this;b instanceof String&&(b=String(b));var c=b.length;d=d||0;for(0>d&&(d=Math.max(d+c,0));d<c;d++){var e=b[d];if(e===a||Object.is(e,a))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,c,d){if(null==a)throw new TypeError("The 'this' value for String.prototype."+d+" must not be null or undefined");if(c instanceof RegExp)throw new TypeError("First argument to String.prototype."+d+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,d){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,d||0)}},"es6","es3");
if(carto.isBrowserSupported()){var iOS=function(){return"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},readinfo=function(a,c){c=c||",";for(var d=new RegExp("(\\"+c+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+c+"\\r\\n]*))","gi"),b=[[]],g;g=d.exec(a);){var e=g[1];e.length&&e!==c&&b.push([]);g=g[2]?g[2].replace(/""/g,'"'):g[3];b[b.length-1].push(g)}return b},hideInfo=function(){displayInfo=
0;document.getElementById("info").style.display="none";document.getElementById("map").style.width="100%"},animatehandler=function(){slider.get()<Object.keys(pipDisplay).length-1&1==animate?(slider.set(parseInt(slider.get())+5),setTimeout(animatehandler,200)):(document.getElementById("animatecontrol").innerHTML='<path style="fill:white" d="M8 5v14l11-7z"/>',animate=0)},dragElement=function(a){function c(c){c=c||window.event;b=e-c.clientX;g=f-c.clientY;e=c.clientX;f=c.clientY;c=a.offsetLeft-b;var d=
a.offsetTop-g;c<viewport.left||d<viewport.top||c+rect.width>viewport.right+350||d+rect.height>viewport.bottom||(a.style.top=a.offsetTop-g+"px",a.style.left=a.offsetLeft-b+"px")}function d(){document.onmouseup=null;document.onmousemove=null}var b=0,g=0,e=0,f=0;a.onmousedown=function(b){b=b||window.event;e=b.clientX;f=b.clientY;rect=a.getBoundingClientRect();viewport.bottom=window.innerHeight-PADDING;viewport.left=PADDING;viewport.right=window.innerWidth-PADDING;viewport.top=PADDING;document.onmouseup=
d;document.onmousemove=c}},drawinfo=function(a,c,d){csvtestarray=readinfo(csvtest,"|");currentcountry=[];showdate=pipFormats[d];for(var b=0;b<csvtestarray.length;b++)csvtestarray[b][0]==a&&currentcountry.push(csvtestarray[b]);dashboardfound=authorityfound=0;null!=countryinfo[a]&&(""!=countryinfo[a][0]["3"]&&(site1=countryinfo[a][0]["3"],site1link=countryinfo[a][0]["4"],authorityfound=1,eusite1=countryinfo.EU[0]["3"],eusite1link=countryinfo.EU[0]["4"]),"1"==countryinfo[a][0]["8"]&&(dashboard=countryinfo[a][0]["7"],
dashboardfound=1,eudashboard=countryinfo.EU[0]["7"]));eu="AUT BEL BGR HRV CYP CZE DNK EST FIN FRA DEU GRC HUN IRL ITA LVA LTU LUX MLT NLD POL PRT ROU SVK SVN ESP SWE".split(" ");currentpoliciesc=[];currentpoliciesp=[];for(b=0;b<currentcountry.length;b++)(currentcountry[b][3]<parseInt(showdate.slice(0,2))|currentcountry[b][3]==parseInt(showdate.slice(0,2))&currentcountry[b][4]<=parseInt(showdate.slice(2)))&""!=currentcountry[b][7]&(currentcountry[b][5]>parseInt(showdate.slice(0,2))|currentcountry[b][5]==
parseInt(showdate.slice(0,2))&currentcountry[b][6]>=parseInt(showdate.slice(2)))&"NONE"!=currentcountry[b][2]&("Essentials-only Exception"==currentcountry[b][2]|"Citizen Exception"==currentcountry[b][2]|"Specific Country(ies) Exception"==currentcountry[b][2]|"Workers Exception"==currentcountry[b][2])&&currentpoliciesc.push(currentcountry[b]);for(b=0;b<currentcountry.length;b++)(currentcountry[b][3]<parseInt(showdate.slice(0,2))|currentcountry[b][3]==parseInt(showdate.slice(0,2))&currentcountry[b][4]<=
parseInt(showdate.slice(2)))&""!=currentcountry[b][7]&(currentcountry[b][5]>parseInt(showdate.slice(0,2))|currentcountry[b][5]==parseInt(showdate.slice(0,2))&currentcountry[b][6]>=parseInt(showdate.slice(2)))&"NONE"!=currentcountry[b][2]&("Visa ban"==currentcountry[b][2]|"Citizenship ban"==currentcountry[b][2]|"Travel history ban"==currentcountry[b][2]|"Border Closure"==currentcountry[b][2])&&currentpoliciesp.push(currentcountry[b]);currentpoliciesc.sort(function(a,b){return a[4]-b[4]});currentpoliciesc.sort(function(a,
b){return a[3]-b[3]});currentpoliciesp.sort(function(a,b){return a[4]-b[4]});currentpoliciesp.sort(function(a,b){return a[3]-b[3]});infohtml='\n        <div id="subinfo">\n          <svg xmlns="http://www.w3.org/2000/svg" onclick="hideInfo()" style="cursor: pointer;position:fixed;top:40px;right:20px;"width="24" height="24" viewBox="0 0 24 24"><path style="stroke: #aaa;fill: #aaa;" d="M14.59 8L12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/></svg>\n          <h1 class="CDB-infowindow-title " style="padding-top:20px">\n            '+
c+"<hr>\n          </h1>\n          \n          <div id='policytable'>\n          <h2 class=\"CDB-infowindow-subtitle\">Country-Specific Resources:</h2>";authorityfound&&(infohtml+="Entity responsible for border closures:\n          <p><a href='"+site1link+'\'target="_blank" rel="noopener noreferrer">'+site1+"</a></p>");eu.includes(a)&&(infohtml+="<p><a href='"+eusite1link+'\'target="_blank" rel="noopener noreferrer">'+eusite1+"</a></p>");dashboardfound&&(infohtml+="<p><a href='"+dashboard+'\'target="_blank" rel="noopener noreferrer">Covid-19 Dashboard</a></p>');
eu.includes(a)&&(infohtml+="<p><a href='"+eudashboard+'\'target="_blank" rel="noopener noreferrer">European Union Covid-19 Dashboard</a></p>');infohtml+='\n          <h2 class="CDB-infowindow-subtitle">Policies active on '+monthdisplay[parseInt(showdate.slice(0,2))-1]+" "+showdate.slice(2)+":</h2>";if(0<currentpoliciesc.length)for(infohtml+='\n            <h3 style="color:white">Complete Closures</h3>\n            <table style="width:100%"><tr>\n            <th>Policy Type</th>\n            <th>Date \n            Implemented</th>\n            <th>Date Expires</th>\n            <th>Source</th>\n            </tr>',
b=0;b<currentpoliciesc.length;b++)infohtml+="<tr><th>\n            "+currentpoliciesc[b][2]+" </th><th> \n            "+currentpoliciesc[b][3]+" / "+currentpoliciesc[b][4]+" </th><th> ",infohtml="12"==currentpoliciesc[b][5]&"31"==currentpoliciesc[b][6]?infohtml+"None </th><th> ":infohtml+(currentpoliciesc[b][5]+" / "+currentpoliciesc[b][6]+" </th><th> "),currentpoliciesc[b][7].includes("web.archive.org")?(url=currentpoliciesc[b][7].split("web.archive.org")[1].split("/"),url.shift(),url.shift(),url.shift(),
url[0].includes("http")&&url.shift(),url="http://"+url.join("/"),infohtml+="<a href='"+url+'\' target="_blank" rel="noopener noreferrer" >Source</a><br><a href=\''+currentpoliciesc[b][7]+'\' target="_blank" rel="noopener noreferrer" >(Archive)</a> </th></tr>'):infohtml+="<a href='"+currentpoliciesc[b][7]+'\' target="_blank" rel="noopener noreferrer" >Source</a> </th></tr>';else infohtml+='<h3 style="color:white">Complete Closures</h3>&nbsp;&nbsp;&nbsp;No Complete Closures at this date';infohtml+=
"</table></div>";if(0<currentpoliciesp.length)for(infohtml+='\n            <h3 style="color:white">Partial Closures</h3>\n            <table style="width:100%"><tr>\n            <th>Policy Type</th>\n            <th>Date Implemented</th>\n            <th>Date Expires</th>\n            <th>Source</th>\n            </tr>',b=0;b<currentpoliciesp.length;b++)infohtml+="<tr><th>\n            "+currentpoliciesp[b][2]+" </th><th> \n            "+currentpoliciesp[b][3]+" / "+currentpoliciesp[b][4]+" </th><th> ",
infohtml="12"==currentpoliciesp[b][5]&"31"==currentpoliciesp[b][6]?infohtml+"None</th><th> ":infohtml+(currentpoliciesp[b][5]+" / "+currentpoliciesp[b][6]+" </th><th> "),currentpoliciesp[b][7].includes("web.archive.org")?(url=currentpoliciesp[b][7].split("web.archive.org")[1].split("/"),url.shift(),url.shift(),url.shift(),url[0].includes("http")&&url.shift(),url="http://"+url.join("/"),infohtml+="<a href='"+url+'\' target="_blank" rel="noopener noreferrer" >Source</a><br><a href=\''+currentpoliciesp[b][7]+
'\' target="_blank" rel="noopener noreferrer" >(Archive)</a> </th></tr>'):infohtml+="<a href='"+currentpoliciesp[b][7]+'\' target="_blank" rel="noopener noreferrer" >Source</a> </th></tr>';else infohtml+='<h3 style="color:white">Partial Closures</h3>&nbsp;&nbsp;&nbsp;No Partial Closures at this date';infohtml+="</table><h3 class=\"CDB-infowindow-subtitle\" style=\"color:white\">Covid-19 Stats:</h3>\n<div id='countrychart'></div><div id='countrychart2'></div><div id='attr' style=\"font-size:10px\">Source: <a href='https://github.com/CSSEGISandData/COVID-19'>JHU CSSE COVID-19 Data</a></div><div id='heatmap'></div>\n";
document.getElementById("info").innerHTML=infohtml;"none"==document.getElementById("info").style.display|""==document.getElementById("info").style.display&&(document.getElementById("info").style.display="block",document.getElementById("map").style.width=mapwidth-document.getElementById("info").offsetWidth+"px");var g=[];b=[];chartwidth=.9*document.getElementById("subinfo").offsetWidth;if(0<getCountryByCode(a).length){casefromjson=getCountryByCode(a)[0].properties;for(var e=1;e<=currentMonth+1;e++)for(var f=
1;f<=days[e-1]&&!(e==currentMonth+1&f>currentday);f++)1==e&22>f||(g.push(casefromjson[String(e)+"_"+String(f)+"_20"]),b.push(casefromjson[String(e)+"_"+String(f)+"_20d"]));b=[{type:"bar",x:datesforchart,y:g,name:"Confirmed Cases",mode:"lines",marker:{color:"#7F7F7F"},line:{color:"#9f9f9f"}},{type:"bar",mode:"lines",name:"Deaths",x:datesforchart,y:b,marker:{color:"#bf000d"},line:{color:"#7F7F7F"},yaxis:"y"}];var h={width:chartwidth,height:chartwidth/2,paper_bgcolor:"#222",plot_bgcolor:"#222",margin:{l:20,
r:20,b:40,t:20,pad:4},showlegend:!1,xaxis:{autorange:!0,gridcolor:"#ffffff10",tickfont:{family:'"Poppins",Old Standard TT, serif',color:"#ffffff80",size:14},tickcolor:"#ffffff80",tickmode:"auto",nticks:8,fixedrange:!0,tickformat:"%b"},yaxis:{hoverformat:".3s",gridcolor:"#ffffff10",tickfont:{family:"Poppins,Old Standard TT, serif",color:"#ffffff80",size:14},tickcolor:"#ffffff80",autorange:!0,fixedrange:!0,automargin:!0},yaxis2:{autorange:!0,automargin:!0,overlaying:"y",side:"right"}};Plotly.newPlot("countrychart",
b,h,{displayModeBar:!1})}else document.getElementById("countrychart").innerHTML="No Case Data Available";f=new Date;e=new Date(f.getFullYear(),0,0);g=e.getDay();f=f-e+6E4*(e.getTimezoneOffset()-f.getTimezoneOffset());e=Math.floor(f/864E5);xvalues=[];yvalues=[];zvalues=[];for(f=g;0<f;f--)zvalues.push(null);for(f=0;f<=e;f++)yvalues.push(Math.floor(f/7)),xvalues.push(f%7);categoriespriority={"Workers Exception":0,"Specific Country(ies) Exception":1,"Citizen Exception":2,"Essentials-only Exception":3,
"Visa ban":4,"Citizenship ban":5,"Travel history ban":6,"Border Closure":7,NONE:8};for(e=1;e<=currentMonth+1;e++)for(f=1;f<=days[e-1]&&!(e==currentMonth+1&f>currentday);f++){policy=8;for(b=0;b<currentcountry.length;b++)(e>currentcountry[b][3]|e==currentcountry[b][3]&f>=currentcountry[b][4])&(e<currentcountry[b][5]|e==currentcountry[b][5]&f<=currentcountry[b][6])&&policy>categoriespriority[currentcountry[b][2]]&&(policy=categoriespriority[currentcountry[b][2]]);zvalues.push(policy)}f="#a8dbd9 #85c4c9 #4f90a6 #2a5674 #672044 #ad466c #e38191 #ffc6c4 #888".split(" ");
colorscaleValue=[];for(e=0;8>=e;e++)colorscaleValue.push([e/9,f[e]]),colorscaleValue.push([(e+1)/9,f[e]]);var k=document.getElementById("heatmap");b=[{x:xvalues,y:yvalues,z:zvalues,zmin:0,zmax:8,type:"heatmap",colorscale:colorscaleValue,showscale:!1,xgap:3,ygap:3,hoverongaps:!1,hoverinfo:"none",colorbar:{autotick:!1,tick0:0,dtick:1}}];h={width:400,height:880,paper_bgcolor:"#222",plot_bgcolor:"#222",annotations:[],xaxis:{ticks:"",side:"top",tickmode:"array",ticktext:"Mon Tue Wed Thu Fri Sat Sun".split(" "),
tickvals:[0,1,2,3,4,5,6],showline:!1,showgrid:!1,zeroline:!1,fixedrange:!0,tickfont:{family:"Poppins,Old Standard TT, serif",size:14,color:"#fff"}},yaxis:{ticks:"",ticksuffix:" ",tickmode:"array",ticktext:"Jan ;Feb ;Mar ;Apr ;May ;Jun ;Jul ;Aug ;Sep ;Oct ;Nov ".split(";"),tickvals:[0,4,8,13,17,22,26,30,35,39,43],autorange:"reversed",autosize:!0,showline:!1,fixedrange:!0,showgrid:!1,zeroline:!1,tickfont:{family:"Poppins,Old Standard TT, serif",size:14,color:"#fff"}}};dayannotation=g;for(e=1;e<=currentMonth+
1;e++)for(f=1;f<=days[e-1]&&!(e==currentMonth+1&f>currentday);f++)h.annotations.push({xref:"x1",yref:"y1",x:xvalues[dayannotation],y:yvalues[dayannotation],text:f,font:{family:"Poppins,Arial",size:11,color:0==zvalues[dayannotation]|7==zvalues[dayannotation]?"black":"white"},showarrow:!1}),dayannotation+=1;Plotly.newPlot("heatmap",b,h,{displayModeBar:!1});k.on("plotly_click",function(b){d=23>=b.points[0].pointIndex?0:b.points[0].pointIndex-23;slider.set(b.points[0].pointIndex-23);drawinfo(a,c,d)})},
updateInfo=function(a){0<a.features.length?(a=a.features[0].variables,iso3=a.iso3.value,country=a.country.value,date=parseInt(slider.get()),displayInfo=1,drawinfo(iso3,country,date)):hideInfo()},pauseslider=function(){animate=0;document.getElementById("animatecontrol").onclick="animateslider()"},animateslider=function(){hideInfo();1==animate?(document.getElementById("animatecontrol").innerHTML='<path style="fill:white" d="M8 5v14l11-7z"/>',animate=0):(animate=1,document.getElementById("animatecontrol").innerHTML=
'<path style="fill:white" d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>',parseInt(slider.get())==Object.keys(pipDisplay).length-1&&slider.set(0),setTimeout(animatehandler,1))},hideLoader=function(){document.getElementById("loader").style.opacity="0";document.getElementById("loader").style.pointerEvents="none"},hideSpinner=function(){document.getElementById("spinner").innerHTML='<button onclick="hideLoader()">Go to the Map</button>'},numberWithCommas=function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,
",")},checkAll=function(){for(var a=document.getElementsByName("categories"),c=0;c<a.length;c++)"checkbox"==a[c].type&&(a[c].checked=!0)},onSlide=function(a,c){showdate=pipFormats[parseInt(a[0])];popup.remove();viz[1].variables.selected_d=parseInt(a[0])+21;viz[2].variables.selected_d=parseInt(a[0])+21;viz[3].variables.selected_d=parseInt(a[0])+21;"0"==pipFormats[parseInt(a[0])].charAt(0)&"0"==pipFormats[parseInt(a[0])].charAt(2)&!iOS()?(viz2a.variables.date=viz2a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(1)+
"_"+pipFormats[parseInt(a[0])].charAt(3)+"_20"],viz2a.variables.ddate=viz2a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(3)+"_20d"],viz3a.variables.date=viz3a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(3)+"_20d"],viz3a.variables.cdate=viz3a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(3)+"_20"]):"0"==pipFormats[parseInt(a[0])].charAt(0)&"0"!=pipFormats[parseInt(a[0])].charAt(2)&
!iOS()?(viz2a.variables.date=viz2a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(2)+pipFormats[parseInt(a[0])].charAt(3)+"_20"],viz2a.variables.ddate=viz2a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(2)+pipFormats[parseInt(a[0])].charAt(3)+"_20d"],viz3a.variables.date=viz3a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(2)+pipFormats[parseInt(a[0])].charAt(3)+"_20d"],
viz3a.variables.cdate=viz3a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(2)+pipFormats[parseInt(a[0])].charAt(3)+"_20"]):"0"!=pipFormats[parseInt(a[0])].charAt(0)&"0"==pipFormats[parseInt(a[0])].charAt(2)&!iOS()?(viz2a.variables.date=viz2a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(0)+pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(3)+"_20"],viz2a.variables.ddate=viz2a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(0)+
pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(3)+"_20d"],viz3a.variables.date=viz3a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(0)+pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(3)+"_20d"],viz3a.variables.cdate=viz3a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(0)+pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(3)+"_20"]):iOS()||(viz2a.variables.date=viz2a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(0)+
pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(2)+pipFormats[parseInt(a[0])].charAt(3)+"_20"],viz2a.variables.ddate=viz2a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(0)+pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(2)+pipFormats[parseInt(a[0])].charAt(3)+"_20d"],viz3a.variables.date=viz3a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(0)+pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(2)+pipFormats[parseInt(a[0])].charAt(3)+
"_20d"],viz3a.variables.cdate=viz3a.variables["cnt"+pipFormats[parseInt(a[0])].charAt(0)+pipFormats[parseInt(a[0])].charAt(1)+"_"+pipFormats[parseInt(a[0])].charAt(2)+pipFormats[parseInt(a[0])].charAt(3)+"_20"]);1==layerLoaded&1==displayInfo&&drawinfo(iso3,country,parseInt(a[0]))},debounce=function(a,c,d){var b;return function(){var g=this,e=arguments,f=d&&!b;clearTimeout(b);b=setTimeout(function(){b=null;d||a.apply(g,e)},c);f&&a.apply(g,e)}},rgbToHex=function(a){return"#"+(16777216+(a.r<<16)+(a.g<<
8)+a.b).toString(16).slice(1)},toggleCases=function(a){layer2a.visible?(layer2a.hide(),layer3a.hide()):(layer2a.show(),layer3a.show())},toggleCategory=function(a){a=a.currentTarget.getAttribute("category");4>a&&(a=Math.abs(a-3));layer[Math.floor(a/3)+1].viz.variables["po"+a+"s"]=0!=layer[Math.floor(a/3)+1].viz.variables["po"+a+"s"].value?0:1;drawHistogram()},setupWidget=function(){var a=document.getElementsByClassName("js-checkbox"),c;for(c in a)a.item(c).addEventListener("change",toggleCategory);
a=document.getElementsByClassName("js-checkbox-stat").item(0);iOS()||a.addEventListener("change",toggleCases)},showlegend=function(){document.getElementById("toolbox").style.display="unset";document.getElementById("minilegend").style.display="none"},minimizelegend=function(){document.getElementById("toolbox").style.display="none";document.getElementById("minilegend").style.display="unset"},generateLegend=function(){for(var a='<div class="tooltip"><h4>Complete Closures <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path style="fill:white" d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/></svg></h4></label>\n            <span class="tooltiptext">A new policy in which all newcomers are banned from all ports of entry - AIR, LAND, and SEA - with limited exceptions, including citizens, nationals from a specified country or set of up to 25 countries, and/or essential reasons, e.g. health emergencies, extreme humanitarian/diplomatic reasons, dignitaries, cargo flights, commercial transport, essential deliveries, permanent residents, existing visa holders, and family members of citizens</span></div>',
c=0;7>=c;c++)4==c&&(a+='<div class="tooltip"><h4>Partial Closures <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path style="fill:white" d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/></svg></h4></label>\n            <span class="tooltiptext">A new policy which restricts access of specific groups of people, whether by certain nationalities, travel histories; those entering through a specified land, sea or air border; OR all land borders closed OR all air borders closed OR all sea borders closed (but not all three)</span></div>'),
color=colormap[categories[c]],a+='<li>\n            <label for="js-checkbox-'+c+'">\n            <input\n              id="js-checkbox-'+c+'"\n              class="js-checkbox"\n              type="checkbox"\n              name="categories"\n              category="'+c+'"\n            checked>\n            <span class="point-mark" style="background-color:'+color+';"></span>\n            <div class="tooltip">'+categories[c]+' <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path style="fill:white" d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/></svg></label>\n            <span class="tooltiptext">'+
tooltipcategories[categories[c]]+"</span></div>\n          </li>\n";a+='<li>\n            <div class="tooltip"><label for="js-checkbox-8">\n            <span class="point-mark" style="background-color:#888;"></span>No Data <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"><path style="fill:white" d="M11 18h2v-2h-2v2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4z"/></svg></label>\n            <span class="tooltiptext">'+
tooltipcategories[categories[8]]+"</span></div>\n          </li>\n";iOS()||(a+='<h3>Covid-19 Stats <label for="js-checkbox-stat">\n            <input\n              id="js-checkbox-stat"\n              class="js-checkbox-stat"\n              type="checkbox"\n              name="categories"\n              category="stats"\n            checked></label></h3>\n      <svg width="300" height="65"><g transform="translate(0, 0)" id="vis"><g class="legend-wrap" transform="translate(-120,-20)"><g class="values-wrap"><circle class="values values-25" r="25" cx="159" cy="55" style="fill: rgb(102, 102, 102); stroke: rgb(255, 255, 255); opacity: 0.5;"></circle><circle class="values values-0.6875" r="4.145780987944249" cx="159" cy="75.85421901205575" style="fill: rgb(255, 255, 255); stroke: rgb(255, 255, 255); opacity: 0.5;"></circle></g><g class="values-line-wrap"><line x1="159" x2="198" y1="30" y2="30" opacity="0.5" style="stroke: rgb(255, 255, 255);"></line><line x1="159" x2="198" y1="71.7084380241115" y2="71.7084380241115" opacity="0.5" style="stroke: rgb(255, 255, 255);"></line></g><g class="values-labels-wrap"><text x="278" y="34" shape-rendering="crispEdges" font-family="\'Poppins\',Arial" font-size="14" style="text-anchor: end; fill: rgb(200, 200, 200);"><tspan x="314" dy="0em">Confirmed Cases</tspan></text><text x="278" y="75.7084380241115" shape-rendering="crispEdges" font-family="Arial" font-size="14" style="text-anchor: end; fill: rgb(255, 255, 255);"><tspan x="314" dy="0em">Confirmed Deaths</tspan></text></g></g></g></svg>');
document.getElementById("content").innerHTML=a},dotName=function(a){if(0<a.features.length){var c=a.features[0].variables;cases=numberWithCommas(c.date.value);deaths=numberWithCommas(c.ddate.value);popup.setHTML('\n          <div class="popupinfo">\n          <h2 >\n          '+c.name.value+"\n          </h2>\n          <h3 >Confirmed Cases: "+cases+"</h3>\n          <h3 >Confirmed Deaths: "+deaths+"</h3>\n          </div>\n          ");popup.setLngLat([a.coordinates.lng,a.coordinates.lat]);popup.isOpen()||
popup.addTo(map)}else popup.remove()},getCountryByCode=function(a){return casedata.features.filter(function(c){return c.properties.ISO3==a})},drawHistogram=function(){var a=document.querySelector("as-category-widget"),c=[];if(800<$(window).height()){if(document.querySelector("as-category-widget").style.visibility="visible",1==layerLoaded){for(i=0;8>i;i++)viz[Math.floor(i/3)+1].variables["po"+i+"s"].value&0<viz[Math.floor(i/3)+1].variables["histogram"+i].value.length&&(""==viz[Math.floor(i/3)+1].variables["histogram"+
i].value[0].x&layer[Math.floor(i/3)+1].visible&1<viz[Math.floor(i/3)+1].variables["histogram"+i].value.length?c.push(viz[Math.floor(i/3)+1].variables["histogram"+i].value[1]):""!=viz[Math.floor(i/3)+1].variables["histogram"+i].value[0].x&&c.push(viz[Math.floor(i/3)+1].variables["histogram"+i].value[0]));c=c.sort(function(a,b){return b.y-a.y});a.categories=c.map(function(a){return{name:a.x,value:a.y,color:colormap[a.x]}})}}else document.querySelector("as-category-widget").style.visibility="hidden",
document.querySelector("as-category-widget").style.height="0px"},s=carto.expressions,map=new mapboxgl.Map({container:"map",style:"mapstyle.json",center:[-20,30],pitchWithRotate:!1,dragRotate:!1,touchPitch:!1,boxZoom:!1,trackResize:1,customAttribution:"<a href='https://docs.google.com/forms/d/1OGd-56pqT0iRPGv6iJdTnIWWI5vkbF2faAnTz5sDNxI/edit'>Suggest an edit</a>",renderWorldCopies:!1,maxBounds:new mapboxgl.LngLatBounds(new mapboxgl.LngLat(-220,-70),new mapboxgl.LngLat(180,80)),minZoom:2,maxZoom:7,
zoom:2});map.touchZoomRotate.disableRotation();var nav=new mapboxgl.NavigationControl({showCompass:!1});map.addControl(nav,"top-left");carto.setDefaultAuth({username:"maryshiraef",apiKey:"default_public"});popup=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});var layerLoaded=0,displayInfo=0,animate=0;days=[31,29,31,30,31,30,31,31,30,31,30,31];months=[0,1,2,3,4,5,6,7,8,9,10,11];monthformat={0:"01",1:"02",2:"03",3:"04",4:"05",5:"06",6:"07",7:"08",8:"09",9:"10",10:"11"};monthdisplay={0:"Jan ",1:"Feb ",
2:"Mar ",3:"Apr ",4:"May ",5:"Jun ",6:"Jul ",7:"Aug ",8:"Sep ",9:"Oct ",10:"Nov ",11:"Dec "};var pipFormats={},pipDisplay={},pipValues=[],currentMonth=10,currentday=29,displaydate="",formatdate="",limitWidth=900>=document.body.offsetWidth,datesforchart=[];country=iso3="";var countryinfo;$.getJSON("countryinfo.json",function(a){countryinfo=a});for(var currentdate=monthformat[currentMonth]+String("0"+currentday).slice(-2),iter=0,$jscomp$iter$0=$jscomp.makeIterator(months),$jscomp$key$month=$jscomp$iter$0.next();!$jscomp$key$month.done;$jscomp$key$month=
$jscomp$iter$0.next()){var month=$jscomp$key$month.value;if(month>currentMonth)break;0<month&(limitWidth&month%2|!limitWidth)&&pipValues.push(iter);for(var day=1;day<=days[month]&&!(month==currentMonth&day>currentday);day++)0==month&22>day||(formatdate=monthformat[month]+String("0"+day).slice(-2),pipFormats[iter]=formatdate,displaydate=monthdisplay[month]+String("0"+day).slice(-2),pipDisplay[iter]=displaydate,iter++)}--iter;10<iter-pipValues[pipValues.length-1]&&pipValues.push(iter);slider=noUiSlider.create($(".slider")[0],
{start:iter,step:1,snap:!1,animate:!0,orientation:"horizontal",range:{min:[0],max:iter},tooltips:[{to:function(a){return pipDisplay[parseInt(a)]}}],pips:{mode:"values",values:pipValues,density:5,format:{to:function(a){return pipDisplay[parseInt(a)]}}}});for(month=1;month<=currentMonth+1;month++)for(day=1;day<=days[month-1]&&!(month==currentMonth+1&day>currentday);day++)1==month&22>day||datesforchart.push("2020-"+String(month)+"-"+String(day));document.getElementsByClassName("noUi-value noUi-value-horizontal noUi-value-large")[2].outerHTML+=
'\n        <div id="pandemicNote" class="noUi-value noUi-value-horizontal noUi-value-large" data-value="39" style="left: 20.7447%; transform: translate(0,-250%);width: 262px; color: #ff0000">Mar 11, WHO declares pandemic</div>';categories="Essentials-only Exception;Citizen Exception;Specific Country(ies) Exception;Workers Exception;Visa ban(s);Citizenship ban(s);Travel history ban(s);Border Closure(s);NONE".split(";");tooltipcategories={"Workers Exception":"A complete closure with exceptions for specific work permit status holders",
"Specific Country(ies) Exception":"A complete closure with exceptions for essentials and for nationals from a specific country or listed set of countries (up to 25)","Citizen Exception":"A complete closure with exceptions for essentials and for citizens (including citizens, permanent residents, and/or the family members of citizens and permanent residents)","Essentials-only Exception":"A complete closure with exceptions for essentials but not for citizens","Visa ban(s)":"A partial closure which bans the application for new visas, whether all visa seekers or impacting those from specified countries",
"Citizenship ban(s)":'A partial closure which bans foreign nationals from one country or group of countries, e.g. "entry to the country is denied to foreign nationals from Austria, Belgium, and France"',"Travel history ban(s)":'A partial closure which bans travelers who, regardless of nationality, have recently travelled  through or from a specified country or group of countries, e.g. for "All travelers who have been to or travelled through China, Hong Kong, Iran, Italy, and Japan are advised to not enter the country, and may be denied entry"',
"Border Closure(s)":"A partial closure which impacts those entering through a specified land, sea or air border; OR all land borders closed OR all air borders closed OR all sea borders closed (but not all three)",NONE:"No policy recorded at this date"};colormap={"Workers Exception":"#a8dbd9","Specific Country(ies) Exception":"#85c4c9","Citizen Exception":"#4f90a6","Essentials-only Exception":"#2a5674","Visa ban(s)":"#672044","Citizenship ban(s)":"#ad466c","Travel history ban(s)":"#e38191","Border Closure(s)":"#ffc6c4",
NONE:"#888"};var colors="#a8dbd9 #85c4c9 #4f90a6 #2a5674 #672044 #ad466c #e38191 #ffc6c4 #888".split(" "),source=new carto.source.Dataset("cobap1129"),source3=new carto.source.Dataset("world_borders_hd");layer=[];viz=[];var policiesViz2="\n      @iso3 : $iso3\n      @country: $country\n      @po0s : 1\n      @po1s : 1\n      @po2s : 1\n      @po0 : ($start_0d <= @selected_d) and ($end_0d > @selected_d) and @po0s\n      @po1 : ($start_1d <= @selected_d) and ($end_1d > @selected_d) and @po1s     \n      @po2 : ($start_2d <= @selected_d) and ($end_2d > @selected_d) and @po2s\n      @selected_d : 246\n      @histogram0 : viewportHistogram($policy_0, ['Workers Exception'])\n      @histogram1 : viewportHistogram($policy_1, ['Specific Country(ies) Exception'])\n      @histogram2 : viewportHistogram($policy_2, ['Citizen Exception'])\n      @list: viewportFeatures($policy_0)\n      filter: @po0 or @po1 or @po2\n      color: blend(#4f90a6,\n             blend(#85c4c9,#a8dbd9,@po0),@po0 or @po1)\n      strokeColor: rgba(0,0,0,0.2)\n      strokeWidth: 1 ",
policiesViz1="\n      @country: $country\n      @iso3 : $iso3\n      @po3s : 1\n      @po4s : 1\n      @po5s : 1\n      @po3 : ($start_3d <= @selected_d) and ($end_3d > @selected_d) and @po3s\n      @po4 : ($start_4d <= @selected_d) and ($end_4d > @selected_d) and @po4s\n      @po5 : ($start_5d <= @selected_d) and($end_5d > @selected_d) and @po5s\n      @histogram3 : viewportHistogram($policy_3, ['Essentials-only Exception'])\n      @histogram4 : viewportHistogram($policy_4, ['Visa ban(s)'])\n      @histogram5 : viewportHistogram($policy_5, ['Citizenship ban(s)'])\n      @selected_d : 246\n      color: blend(#ad466c,\n             blend(#672044,#2a5674,@po3),@po4 or @po3)\n      filter: @po3 or @po4 or @po5 \n      strokeColor: rgba(0,0,0,0.2)\n      strokeWidth: 1 ",
policiesViz0="\n      @country: $country\n      @iso3 : $iso3\n      @po6s : 1\n      @po7s : 1\n      @po6 : ($start_6d <= @selected_d) and($end_6d > @selected_d) and @po6s\n      @po7 : ($start_7d <= @selected_d) and($end_7d > @selected_d) and @po7s \n      @histogram6 : viewportHistogram($policy_6, ['Travel history ban(s)'])\n      @histogram7 : viewportHistogram($policy_7, ['Border Closure(s)']) \n      @selected_d : 246\n      color: blend(#ffc6c4,#e38191,@po6)\n      filter: @po6 or @po7 \n      strokeColor: rgba(0,0,0,0.2)\n      strokeWidth: 1 ",
backgroundViz="\n        @iso3: $adm0_a3\n        @country: $admin\n        color: #888,\n        strokeColor: rgba(0,0,0,0.2)\n        strokeWidth: 1 ";viz[0]=new carto.Viz(backgroundViz);viz[1]=new carto.Viz(policiesViz2);viz[2]=new carto.Viz(policiesViz1);viz[3]=new carto.Viz(policiesViz0);layer[0]=new carto.Layer("allcountries",source3,viz[0]);layer[1]=new carto.Layer("policies2",source,viz[1]);layer[2]=new carto.Layer("policies1",source,viz[2]);layer[3]=new carto.Layer("policies0",source,viz[3]);
layer[0].addTo(map,"watername_ocean");layer[3].addTo(map,"watername_ocean");layer[2].addTo(map,"watername_ocean");layer[1].addTo(map,"watername_ocean");mapwidth=document.getElementById("map").offsetWidth;var interactivity=new carto.Interactivity(layer[0]);interactivity.on("featureClick",updateInfo);carto.on("loaded",layer,function(){drawHistogram();hideSpinner();generateLegend();setupWidget();limitWidth&&minimizelegend();layerLoaded=1});carto.on("updated",layer,function(){drawHistogram()});var source2=
new carto.source.GeoJSON(casedata),stringViz2a="\n            @date: $5_30_20\n            @ddate: $5_30_20d\n            @country: $Country\n            @iso3: $ISO3\n            width: sqrt(@date/600)\n            @widthforlegend : globalEqIntervals (@date,7);\n            @name: $Country\n            color: opacity(#333, .5)\n            strokeWidth : 1\n            ";for(month=1;month<=currentMonth+1;month++)for(day=1;day<=days[month-1]&&!(month==currentMonth+1&day>currentday);day++)1==month&
22>day||(date=String(month)+"_"+String(day)+"_20",stringViz2a+="\n                    @cnt"+date+" : $"+date+"\n                    ");for(month=1;month<=currentMonth+1;month++)for(day=1;day<=days[month-1]&&!(month==currentMonth+1&day>currentday);day++)1==month&22>day||(date=String(month)+"_"+String(day)+"_20d",stringViz2a+="\n                    @cnt"+date+" : $"+date+"\n                    ");var viz2a=new carto.Viz(stringViz2a),layer2a=new carto.Layer("cases",source2,viz2a),interactivity2a=new carto.Interactivity(layer2a),
interactivity2aclick=new carto.Interactivity(layer2a);if(!iOS())interactivity2a.on("featureHover",dotName);var stringViz3a="\n            @date: $5_30_20d\n            @cdate: $5_30_20\n            width: sqrt(@date/600)\n            @widthforlegend : globalEqIntervals (@date,7);\n            @name: $Country\n            strokeWidth : 1\n            color: opacity(#fff, .5)\n            @down: "+window.devicePixelRatio+"*sqrt(@cdate/600)/2 - sqrt(@date/600)/2 - 2\n            transform: translate(0,-@down)\n            ";
for(month=1;month<=currentMonth+1;month++)for(day=1;day<=days[month-1]&&!(month==currentMonth+1&day>currentday);day++)1==month&22>day||(date=String(month)+"_"+String(day)+"_20d",stringViz3a+="\n                    @cnt"+date+" : $"+date+"\n                    ");for(month=1;month<=currentMonth+1;month++)for(day=1;day<=days[month-1]&&!(month==currentMonth+1&day>currentday);day++)1==month&22>day||(date=String(month)+"_"+String(day)+"_20",stringViz3a+="\n                    @cnt"+date+" : $"+date+"\n                    ");
var viz3a=new carto.Viz(stringViz3a),layer3a=new carto.Layer("deaths",source2,viz3a);iOS()||(layer2a.addTo(map),layer3a.addTo(map));slider.on("update",debounce(onSlide,20));dragElement(document.getElementById("toolbox"));var PADDING=8,rect,viewport={bottom:0,left:0,right:0,top:0};window.onresize=function(a){map.resize();mapwidth=document.body.offsetWidth;infoshow="block"==document.getElementById("info").display;document.getElementById("map").style.width=mapwidth-(infoshow?document.getElementById("info").offsetWidth:
0)+"px"};var maptransition=document.getElementById("map");maptransition.addEventListener("transitionend",function(){map.resize();mapwidth=document.getElementById("map").offsetWidth;drawHistogram()})}else{var reasons=carto.unsupportedBrowserReasons();document.getElementById("loader").innerHTML='\n        <div class="open-sans text-white">\n          <h3>Oops! Something went wrong.</h3>\n          <p>Your browser doesn\'t support CARTO VL:</p>\n          <ul>\n              '+reasons.map(function(a){return"<li>"+
a.message+".</li>"}).join("")+"\n          </ul>\n        </div>\n      "};
